<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" href="../../lib/ligerUI/skins/Aqua/css/ligerui-all.css" type="text/css" />
		<link href="../../lib/ligerUI/skins/ligerui-icons.css" rel="stylesheet" type="text/css" />
		<script type="text/javascript" src="../../lib/jquery/jquery-1.9.0.min.js"></script>
		<script type="text/javascript" src="../../lib/ligerUI/js/ligerui.min.js"></script>
		<script type="text/javascript" src="../CommandCode.js"></script>
		<script type="text/javascript" src="ZoneList.js"></script>
		<script type="text/javascript" src="../APIManager.js"></script>
		<link href="../../lib/ligerUI/skins/ligerui-icons.css" rel="stylesheet" type="text/css" />
	</head>

	<script type="text/javascript">
		var grid;

		$(function() {
			window['g']  = $("#maingrid4").ligerGrid({
				columns: [{
						name: 'serverId',
						display: '服务器id',
						width: 200
					},
					{
						name: 'name',
						display: '资源服名称',
						width: 200
					}, {
						name: 'filePath',
						display: '资源路径',
						width: 200
					},{
						name: 'url',
						display: '服务器ip',
						width: 200
					}
				],
				pkName: 'serverId',
				rownumbers: true,
				width: "100%",
				height: "100%",
				data: ZoneList,
				checkbox: true
			});

		});

		function synClick() {
			var rows = g.getSelectedRow();
			if(rows==undefind||rows==null){
				$.ligerDialog.error("没有选中任何资源服");
				return;
			}
			var path="../../../"+AUTH+"uploadExcel";
			console.log(rows);
			var url=path+"?sessionId="
			+parent.sessionId+"&time="+parent.time+"&uid="+parent.userId+"&path="+rows.filePath;
			console.log(url);
			var formData = new FormData();
            formData.append("myfile", document.getElementById("file1").files[0]);   
			jQuery.ajax({url:url,
				 type: "post",
				 type: "POST",
                 data: formData,
                 /**
                 *必须false才会自动加上正确的Content-Type
                 */
                 contentType: false,
                 /**
                 * 必须false才会避开jQuery对 formdata 的默认处理
                 * XMLHttpRequest会对 formdata 进行正确的处理
                 */
                 processData: false,
					success:function(ret,textStatus,jq){
				if (ret.code>0) {
					$.ligerDialog.error('错误码:'+ret.code);
				}else{
					$.ligerDialog.warn("上传成功");
				}
			}});
		}
	</script>

	<body>
                    <input type="file" id="file1" />
		<a class="l-button" style="width:120px" onclick="synClick()">开始同步服务器数据</a>

		<div id="maingrid4" style="margin:0; padding:0"></div>

		</div>

</html>